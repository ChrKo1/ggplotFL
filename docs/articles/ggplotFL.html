<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Plotting FLR objects with ggplotFL and ggplot2 • ggplotFL</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">ggplotFL</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="http://github.com/flr/ggplotFL">
    <span class="fa fa-github fa-lg"></span>
     
    Source
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://flr-project.org/">FLR</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Plotting FLR objects with ggplotFL and ggplot2</h1>
                        <h4 class="author">Iago Mosqueira - European Commission Joint Research Center</h4>
            
          </div>

    
    
<div class="contents">
<div id="using-ggplot2-with-flr-objects" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#using-ggplot2-with-flr-objects" class="anchor"> </a></body></html>Using ggplot2 with <em>FLR</em> objects</h1>
<p>The <code>ggplot2</code> package provides a powerful alternative paradigm for creating both simple and complex plots in R using the ideas of Wilkinson’s <em>Grammar of Graphics</em> <a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>.</p>
<p>To facilitate the use of <code>ggplot2</code> methods in <em>FLR</em>, the <code>ggplotFL</code> package has been created. The main resources on offer in this package are overloaded versions of the <code>ggplot()</code> method that directly accept certaing <em>FLR</em> classes, a new set of basic plots for some <em>FLR</em> classes, based on <code>ggplot2</code> instead of <code>lattice</code>, and some examples and documentation on how best make use of <code>ggplot2</code>’s powerful paradigm and implementation to obtain high quality plots for even fairly complex data structures.</p>
</div>
<div id="the-overloaded-ggplot-method" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#the-overloaded-ggplot-method" class="anchor"> </a></body></html>The overloaded ’ggplot` method</h1>
<p>The standard <code>ggplot</code> functions expects a <code>data.frame</code> for its first argument, <code>data</code>. If <code>ggplot</code> is called on an <em>FLR</em> object, a conversion to <code>data.frame</code> takes place before the result, plus any other arguments provided, get passed to the original <code>ggplot()</code>. Conversion makes use of <code>as.data.frame</code><a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a> methods defined in <code>FLCore</code>, with the <code>cohort</code> argument set to <code>TRUE</code>.</p>
<div id="flquant" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#flquant" class="anchor"> </a></body></html>FLQuant</h2>
<p>Passing an <code>FLQuant</code> object to ggplot, we can specify the names of the dimensions as variables in the plot, where <code>data</code> refers to the column storing the actual numeric values. For example, to plot <code>data</code> (the <code>catch</code> slot from <code>ple4</code> in this case) against year, we could use</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">catch</span>(ple4), <span class="kw">aes</span>(year, data)) +<span class="st"> </span><span class="kw">geom_point</span>() +<span class="st"> </span>
<span class="st">    </span><span class="kw">geom_line</span>() +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">"Catch (t)"</span>) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">""</span>)</code></pre></div>
<div class="figure">
<img src="ggplotFL_files/figure-html/ggflq-1.png" alt="Combined line and point plot of a time series from an FLQuant object." width="432"><p class="caption">
Combined line and point plot of a time series from an FLQuant object.
</p>
</div>
<p>where we pass directly an <code>FLQuant</code> object for the <code>data</code> argument in <code>ggplot</code>, specify an aesthetic mapping (<code>aes(year, data)</code>), and add both points (<code>geom_point()</code>) and lines (<code>geom_line()</code>), together with the appropriate axis labels.</p>
</div>
<div id="flquants" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#flquants" class="anchor"> </a></body></html>FLQuants</h2>
<p>Similarly, we can pass on to <code>ggplot</code> an object of class <code>FLQuants</code>, and the conversion to <code>data.frame</code> will make use of the corresponding method <a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a>. A new column gives the name of each <code>FLQuant</code> in the list, called <code>qname</code>. When can then use it to, for example, define a call to <code>facet_wrap()</code> to obtain a separate subplot per element.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">FLQuants</span>(<span class="dt">Yield =</span> <span class="kw">catch</span>(ple4), <span class="dt">SSB =</span> <span class="kw">ssb</span>(ple4), 
    <span class="dt">F =</span> <span class="kw">fbar</span>(ple4)), <span class="kw">aes</span>(year, data)) +<span class="st"> </span><span class="kw">geom_line</span>() +<span class="st"> </span>
<span class="st">    </span><span class="kw">facet_wrap</span>(~qname, <span class="dt">scales =</span> <span class="st">"free_y"</span>, <span class="dt">nrow =</span> <span class="dv">3</span>) +<span class="st"> </span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">""</span>, <span class="dt">y =</span> <span class="st">""</span>)</code></pre></div>
<div class="figure">
<img src="ggplotFL_files/figure-html/ggflqs-1.png" alt="Facet wrap line plot of time series from an FLQuants object." width="432"><p class="caption">
Facet wrap line plot of time series from an FLQuants object.
</p>
</div>
<p>This procedure is particularly useful when plotting information from objects with multiple <code>FLQuant</code> slots, as a subset of slots can be selected for plotting, and even transformations or computations can be carried out in the call to the <code>FLQuants()</code> creator.</p>
</div>
<div id="flstock" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#flstock" class="anchor"> </a></body></html>FLStock</h2>
<p>A whole FLStock object can also be used as argument to <code>ggplot()</code>, even if the heterogeneity in scale of the data contained makes the plot slightly confusing. For example, we can plot time series of every <code>FLQuant</code> slot in <code>ple4</code>, with color applied to different <code>age</code> dimensions, by calling</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ple4, <span class="kw">aes</span>(year, data)) +<span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> age, 
    <span class="dt">colour =</span> <span class="kw">factor</span>(age))) +<span class="st"> </span><span class="kw">facet_wrap</span>(~slot, <span class="dt">scales =</span> <span class="st">"free"</span>, 
    <span class="dt">nrow =</span> <span class="dv">3</span>) +<span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">""</span>, <span class="dt">y =</span> <span class="st">""</span>) +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"none"</span>)</code></pre></div>
<div class="figure">
<img src="ggplotFL_files/figure-html/ggfls-1.png" alt="Overall `ggplot` of an `FLStock` object, faceted by slot." width="2304"><p class="caption">
Overall <code>ggplot</code> of an <code>FLStock</code> object, faceted by slot.
</p>
</div>
</div>
</div>
<div id="new-plot-methods-for-flr-classes" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#new-plot-methods-for-flr-classes" class="anchor"> </a></body></html>New <code>plot()</code> methods for FLR classes</h1>
<p>The <code>ggplotFL</code> package also provides new versions of the <code>plot</code> method for a number of <em>FLR</em> classes. Each S4 class defined in any <em>FLR</em> package has a <code>plot()</code> method available that provides a quick visual summary of the contents of the object.</p>
<div id="flquant-1" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#flquant-1" class="anchor"> </a></body></html>FLQuant</h2>
<p>The standard <code>plot()</code> method for <code>FLQuant</code> defined in <code>ggplotFL</code> uses the faceting capabilities of <code>ggplot</code> to better present some of the multiple dimensions of these objects. If any dimension, other than <code>year</code> and <code>iter</code>, has length greater than one, it will be added to the formula used by <code>facet_grid</code>. For example, an <code>FLQuant</code> with dimensions</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(<span class="kw">catch.n</span>(ple4))</code></pre></div>
<pre><code>## [1] 10 52  1  1  1  1</code></pre>
<p>will generate a plot with a time series by year of the data it contains, with horizontal facets for the only dimension, other than <code>year</code>, of length greater than 1, <code>age</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">catch.n</span>(ple4))</code></pre></div>
<div class="figure">
<img src="ggplotFL_files/figure-html/pflq-1.png" alt="Standard ggplot2-based plot for an FLQuant object with multiple *year*s and *age*s." width="432"><p class="caption">
Standard ggplot2-based plot for an FLQuant object with multiple <em>year</em>s and <em>age</em>s.
</p>
</div>
<p>For <code>FLQuant</code> objects with iterations, the <code>plot</code> method will calculate, by default, the 50% (median), 10%, 25%, 75% and 90% quantiles, to be plotted as a solid line (50%), a dotted line (90%) and a coloured ribbon (75%).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">rlnorm</span>(<span class="dv">200</span>, <span class="kw">fbar</span>(ple4), <span class="fl">0.15</span>))</code></pre></div>
<pre><code>## Warning in is.na(df$data): is.na() applied to non-
## (list or vector) of type 'NULL'</code></pre>
<div class="figure">
<img src="ggplotFL_files/figure-html/pflq2-1.png" alt="Standard ggplot2-based plot for an FLQuant object with multiple iterations." width="432"><p class="caption">
Standard ggplot2-based plot for an FLQuant object with multiple iterations.
</p>
</div>
<p>Different quantiles can be specified using the <code>probs</code> arguments, and the alpha transparency of the ribbon will be proportional to the probability value. A vector of odd length must be passed, and the central point should be 0.50 so the central tendency line represents the median. The most extreme quantiles will be plotted as dotted lines, while all other will show up as ribbons.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">rlnorm</span>(<span class="dv">200</span>, <span class="kw">fbar</span>(ple4), <span class="fl">0.15</span>), <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.05</span>, 
    <span class="fl">0.1</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>))</code></pre></div>
<pre><code>## Warning in is.na(df$data): is.na() applied to non-
## (list or vector) of type 'NULL'</code></pre>
<div class="figure">
<img src="ggplotFL_files/figure-html/pflq3-1.png" alt="Standard ggplot2-based plot for an FLQuant object with multiple iterations and user-specified quantiles." width="432"><p class="caption">
Standard ggplot2-based plot for an FLQuant object with multiple iterations and user-specified quantiles.
</p>
</div>
</div>
<div id="flquants-1" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#flquants-1" class="anchor"> </a></body></html>FLQuants</h2>
<p>The <code>plot</code> method for <code>FLQuants</code> will now by default show each object in a horizontal panel, with indpendent scales, using ggplot2’s <code>facet_grid</code>. Objects with iterations will have, as with <code>plot</code> for <code>FLQuant</code>, their median, 10%, 25%, 75% and 90% quantiles shown as a black line and red ribbons with different levels of transparency, respectively. The quantiles used can be specified with the <code>probs</code> argument, which must be a vector of length 5 with values between 0 and 1 (see <code>?quantile</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fqs &lt;-<span class="st"> </span><span class="kw">FLQuants</span>(<span class="dt">F =</span> <span class="kw">rlnorm</span>(<span class="dv">200</span>, <span class="kw">fbar</span>(ple4), <span class="fl">0.15</span>), 
    <span class="dt">SSB =</span> <span class="kw">ssb</span>(ple4), <span class="dt">Rec =</span> <span class="kw">rec</span>(ple4), <span class="dt">Catch =</span> <span class="kw">catch</span>(ple4))
<span class="kw">plot</span>(fqs)</code></pre></div>
<div class="figure">
<img src="ggplotFL_files/figure-html/pflqs-1.png" alt="Standard ggplot2-based plot for an FLQuants object with multiple iterations, and consisting of three elements." width="432"><p class="caption">
Standard ggplot2-based plot for an FLQuants object with multiple iterations, and consisting of three elements.
</p>
</div>
<p>To have the subplots placed ona different style, for example a 2x2 grid, you can add a call to <code>facet_wrap</code> to change it, for example,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fqs &lt;-<span class="st"> </span><span class="kw">FLQuants</span>(<span class="dt">F =</span> <span class="kw">rlnorm</span>(<span class="dv">200</span>, <span class="kw">fbar</span>(ple4), <span class="fl">0.15</span>), 
    <span class="dt">SSB =</span> <span class="kw">ssb</span>(ple4), <span class="dt">Rec =</span> <span class="kw">rec</span>(ple4), <span class="dt">Catch =</span> <span class="kw">catch</span>(ple4))
<span class="kw">plot</span>(fqs) +<span class="st"> </span><span class="kw">facet_wrap</span>(~qname, <span class="dt">scales =</span> <span class="st">"free"</span>)</code></pre></div>
<div class="figure">
<img src="ggplotFL_files/figure-html/pflqsg-1.png" alt="Wrap-based ggplot2-based plot for an FLQuants object with multiple iterations, and consisting of three elements." width="432"><p class="caption">
Wrap-based ggplot2-based plot for an FLQuants object with multiple iterations, and consisting of three elements.
</p>
</div>
<p>When plotting object quantiles, it is sometimes useful to show a reduced numnber of individual iterations to better present the expected trajectories of individual realisations. These <code>worm plots</code> can be overlaid using rhe <code>iter</code> argument, as in</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(fqs, <span class="dt">iter =</span> <span class="dv">1</span>:<span class="dv">3</span>)</code></pre></div>
<div class="figure">
<img src="ggplotFL_files/figure-html/pflqsgi-1.png" alt="Wrap-based ggplot2-based plot for an FLQuants object with multiple iterations, and consisting of three elements." width="432"><p class="caption">
Wrap-based ggplot2-based plot for an FLQuants object with multiple iterations, and consisting of three elements.
</p>
</div>
</div>
<div id="flstock-1" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#flstock-1" class="anchor"> </a></body></html>FLStock</h2>
<p>The <code>ggplotFL</code> version of the standard plot for the <code>FLStock</code> class, contains the time series of recruitment (obtained by calling <code>rec()</code>), SSB (<code>ssb()</code>), catch (<code>catch()</code>), and fishing morality or harvest (<code>fbar()</code>). The four panels are now arranged in a 4-row matrix to better display the trends in the time series.</p>
<div class="figure">
<img src="ggplotFL_files/figure-html/pfls-1.png" alt="ggplot2 version of the standard plot() for FLStock, as applied to `ple4`" width="432"><p class="caption">
ggplot2 version of the standard plot() for FLStock, as applied to <code>ple4</code>
</p>
</div>
</div>
<div id="flstocks" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#flstocks" class="anchor"> </a></body></html>FLStocks</h2>
<p>Similarly, the standard <code>plot()</code> method for the <code>FLStocks</code> class now relies on ggplot. For example, we can create an example <code>FLStocks</code> object by splitting the female and male units of <code>ple4sex</code> and adding them as separate elements in the list. A call to <code>plot()</code> would give us the corresponding plot. Remember the object returned by <code>ggplot</code> can always be assigned to a variable in the workspace and modified as required.</p>
<div class="figure">
<img src="ggplotFL_files/figure-html/pflss-1.png" alt="ggplot2 version of the standard plot() for FLStocks, as applied to the sex-separated FLStock object `ple4sex`" width="432"><p class="caption">
ggplot2 version of the standard plot() for FLStocks, as applied to the sex-separated FLStock object <code>ple4sex</code>
</p>
</div>
</div>
<div id="flsr" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#flsr" class="anchor"> </a></body></html>FLSR</h2>
<p>The <code>ggplotFL</code> version of the class plot for <code>FLSR</code> contains the same six panels as before: (1) stock-recruit data, fitted model and lowess smoother, (2) residuals by year, (3) lag 1-correlated residuals, (4) residuals by SSB, (5) residuals qqplot and (6) residuals by fitted values. Blud lines are lo9wess smoothers, to better visualize trends in the data shown.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(nsher)</code></pre></div>
<div class="figure">
<img src="ggplotFL_files/figure-html/pflsr-1.png" alt="Standard ggplot2-based plot for an object of class FLSR." width="432"><p class="caption">
Standard ggplot2-based plot for an object of class FLSR.
</p>
</div>
</div>
<div id="flsrs" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#flsrs" class="anchor"> </a></body></html>FLSRs</h2>
<p>A class plot also exists for <code>FLSRs</code> objects, lists with <code>FLSR</code> elements. The comparison shown involves only the model fit across the different model functions or formulations, but not the residuals diagnostics available for <code>FLSR</code>. The default legend contains the formula of each of the fitted models and the parameter values (or the median if multiple iterations exist).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">srs &lt;-<span class="st"> </span><span class="kw">FLSRs</span>(<span class="kw">sapply</span>(<span class="kw">c</span>(<span class="st">"ricker"</span>, <span class="st">"bevholt"</span>), function(x) {
    y &lt;-<span class="st"> </span>nsher
    <span class="kw">model</span>(y) &lt;-<span class="st"> </span>x
    <span class="kw">return</span>(<span class="kw">fmle</span>(y))
}))</code></pre></div>
<pre><code>## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion

## Warning in uom(op, units(e1), units(e2)): NAs
## introduced by coercion</code></pre>
<pre><code>## Warning in log(x@.Data): NaNs produced

## Warning in log(x@.Data): NaNs produced

## Warning in log(x@.Data): NaNs produced

## Warning in log(x@.Data): NaNs produced</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(srs)</code></pre></div>
<div class="figure">
<img src="ggplotFL_files/figure-html/pflsrs-1.png" alt="Standard ggplot2-based plot for an FLSRs object, using default legend labels." width="432"><p class="caption">
Standard ggplot2-based plot for an FLSRs object, using default legend labels.
</p>
</div>
<p>An alternative labeller function exists (<code>modlabel</code>) that returns the name of the SR model function and the parameter values, by using the <em>legend_label</em> argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(srs, <span class="dt">legend_label =</span> modlabel)</code></pre></div>
<div class="figure">
<img src="ggplotFL_files/figure-html/pflsrs2-1.png" alt="Standard ggplot2-based plot for an FLSRs object, using model names as legend labels." width="432"><p class="caption">
Standard ggplot2-based plot for an FLSRs object, using model names as legend labels.
</p>
</div>
<p>As is common in <code>ggplot2</code>, labels can be specified directly, overwriting those included in the method. You should ignore the warning about scale for <em>colour</em> being replaced.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(srs) +<span class="st"> </span><span class="kw">scale_color_discrete</span>(<span class="dt">name =</span> <span class="st">"SR models"</span>, 
    <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="st">"ricker"</span>, <span class="st">"bevholt"</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">"Ricker"</span>, 
        <span class="st">"Beverton &amp; Holt"</span>))</code></pre></div>
<pre><code>## Scale for 'colour' is already present. Adding
## another scale for 'colour', which will replace
## the existing scale.</code></pre>
<div class="figure">
<img src="ggplotFL_files/figure-html/pflsrs3-1.png" alt="Standard ggplot2-based plot for an FLSRs object, using model names as legend labels." width="432"><p class="caption">
Standard ggplot2-based plot for an FLSRs object, using model names as legend labels.
</p>
</div>
</div>
</div>
<div id="using-ggplot2-directly-by-converting-to-data-frame" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#using-ggplot2-directly-by-converting-to-data-frame" class="anchor"> </a></body></html>Using ggplot2 directly by converting to data.frame</h1>
<p>The methods shown above depend on conversion of <em>FLR</em> objects into <code>data.frame</code>, which can then be passed to <code>ggplot()</code>. Calling <code>ggplot</code> on an <em>FLR</em> object takes care of this conversion behind the scenes, but to obtain full control and develop certains plots, it is best to explicitely convert the <em>FLR</em> objects into a <code>data.frame</code>. Different conventions are used in the naming of the data.frame columns created from various <em>FLR</em> classes, which need to be used when the plot is specified. For further information, please see the help pages for each <code>data.frame()</code> method <a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a>.</p>
</div>
<div id="some-examples" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#some-examples" class="anchor"> </a></body></html>Some examples</h1>
<div id="example-plot-quantiles-of-a-simulation" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#example-plot-quantiles-of-a-simulation" class="anchor"> </a></body></html>Example: plot quantiles of a simulation</h2>
<p>To have full control over a plot of the median (or mean) and the confidence or probability intervals of a simulated or randomized time series, i.e. an <code>FLQuant</code> object with iters, we need to arrange the different values computed from the object in separate columns of a <code>data.frame</code>.</p>
<p>If we start with some random <code>FLQuant</code> object, such as</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fla &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(<span class="dv">100</span>, <span class="kw">FLQuant</span>(<span class="kw">exp</span>(<span class="kw">cumsum</span>(<span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dv">0</span>, 
    <span class="fl">0.1</span>)))), <span class="fl">0.1</span>)
<span class="kw">ggplot</span>(fla, <span class="kw">aes</span>(<span class="kw">factor</span>(year), data)) +<span class="st"> </span><span class="kw">geom_boxplot</span>() +<span class="st"> </span>
<span class="st">    </span><span class="kw">xlab</span>(<span class="st">""</span>)</code></pre></div>
<div class="figure">
<img src="ggplotFL_files/figure-html/exsim1-1.png" alt="Distribution of values of a simulated time series plotted using geom_boxplot()" width="432"><p class="caption">
Distribution of values of a simulated time series plotted using geom_boxplot()
</p>
</div>
<p>we can first compute the necessary statistics on the object itself, as these operations are very efficient on an array. <code>quantile()</code> on an <code>FLQuant</code> will return the specified quantiles along the <code>iter</code> dimension. Let’s extract the 10th, 25th, 50th, 75th and 90th quantiles.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flq &lt;-<span class="st"> </span><span class="kw">quantile</span>(fla, <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.9</span>))</code></pre></div>
<p>The object can now be coerced to a <code>data.frame</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fdf &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(flq, <span class="dt">drop =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>and inspected to see how the 100 <code>iters</code> have been now turned into the five requested quantiles in the iter column</p>
<pre><code>##   year iter     data
## 1    1  10% 2.412439
## 2    2  10% 2.314786
## 3    3  10% 2.540288</code></pre>
<p>The long format <code>data.frame</code> can be reshaped into a wide format one so that we can instruct <code>ggplot</code> to use the quantiles, now in separate columns, to provide limits for the shaded areas in <code>geom_ribbon</code>. To do this we can use <code>reshape</code>, as follows</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fdw &lt;-<span class="st"> </span><span class="kw">reshape</span>(fdf, <span class="dt">timevar =</span> <span class="st">"iter"</span>, <span class="dt">idvar =</span> <span class="kw">c</span>(<span class="st">"year"</span>), 
    <span class="dt">direction =</span> <span class="st">"wide"</span>)</code></pre></div>
<p>This creates a wide <code>data.frame</code> in which the <code>iter</code> column is spread into five columns named as the levels of its conversion into factor</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levels</span>(fdf[, <span class="st">"iter"</span>])</code></pre></div>
<pre><code>## [1] "10%" "25%" "50%" "75%" "90%"</code></pre>
<p>We can now use those five quantile columns when plotting shaded areas using <code>geom_ribbon</code>. Please note that the column names returned by <code>quantile()</code> need to be quoted using backticks.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> fdw, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> <span class="st">`</span><span class="dt">data.50%</span><span class="st">`</span>)) +<span class="st"> </span>
<span class="st">    </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">ymin =</span> <span class="st">`</span><span class="dt">data.10%</span><span class="st">`</span>, <span class="dt">ymax =</span> <span class="st">`</span><span class="dt">data.90%</span><span class="st">`</span>), 
        <span class="dt">fill =</span> <span class="st">"red"</span>, <span class="dt">alpha =</span> <span class="fl">0.15</span>) +<span class="st"> </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, 
    <span class="dt">ymin =</span> <span class="st">`</span><span class="dt">data.25%</span><span class="st">`</span>, <span class="dt">ymax =</span> <span class="st">`</span><span class="dt">data.75%</span><span class="st">`</span>), <span class="dt">fill =</span> <span class="st">"red"</span>, 
    <span class="dt">alpha =</span> <span class="fl">0.25</span>) +<span class="st"> </span><span class="kw">geom_line</span>() +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">"data"</span>)
<span class="kw">print</span>(p)</code></pre></div>
<div class="figure">
<img src="ggplotFL_files/figure-html/exsim7-1.png" alt="Time series with 75% and 90% credibility intervals plotted using geom_ribbon." width="432"><p class="caption">
Time series with 75% and 90% credibility intervals plotted using geom_ribbon.
</p>
</div>
<p>Assigning the result of the call to <code>ggplot()</code> to a variable, as done above, will allow us to reuse the plot later on by modifying or adding components.</p>
</div>
<div id="example-simulation-trajectories-plot" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#example-simulation-trajectories-plot" class="anchor"> </a></body></html>Example: Simulation trajectories plot</h2>
<p>If the result of an stochastic simulation is summarised by showing credibility intervals, it is very informative to plot as well some of the individual iterations as a way of showing the fact that individual trajectories are generally not as smooth as, for example, the median shown in the figure above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fds &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">iter</span>(fla, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">23</span>)))

p +<span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> fds, <span class="kw">aes</span>(year, data, <span class="dt">colour =</span> iter), 
    <span class="dt">size =</span> <span class="fl">0.5</span>) +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"none"</span>)</code></pre></div>
<div class="figure">
<img src="ggplotFL_files/figure-html/exspa-1.png" alt="Spaghetti plot of an stochastic simulation, by calling geom_line on top of the stored ribbon plot." width="432"><p class="caption">
Spaghetti plot of an stochastic simulation, by calling geom_line on top of the stored ribbon plot.
</p>
</div>
<p>This is easy to do in <code>ggplot2</code> by adding an extra element on top of the previous plot, stored in the <code>p</code> object from the code above.</p>
</div>
<div id="example-using-flquants" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#example-using-flquants" class="anchor"> </a></body></html>Example: Using FLQuants</h2>
<p>Coercion using <code>as.data.frame</code>, combined with the use of <code>reshape</code>, or <code>dcast</code> and <code>melt</code> (from the <code>reshape2</code> package<a href="#fn5" class="footnoteRef" id="fnref5"><sup>5</sup></a>), provides the <em>FLR</em> user with the tools required to create a large range of <code>ggplot</code>s out of any <em>FLR</em> object.</p>
<p><strong>TODO</strong>: ADD text &amp; example</p>
</div>
<div id="example-bubble-plots" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#example-bubble-plots" class="anchor"> </a></body></html>Example: Bubble plots</h2>
<p>Bubble plots allow us to represent a third continuous dimension in a scatter plot by sizing points according the value of a variable. For example, catch in numbers by age and year can be visualized using</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="kw">catch.n</span>(ple4), <span class="kw">aes</span>(year, <span class="kw">as.factor</span>(age), <span class="dt">size =</span> data)) +<span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>) +<span class="st"> </span><span class="kw">scale_size</span>(<span class="dt">range =</span> <span class="kw">c</span>(<span class="dv">1</span>, 
    <span class="dv">20</span>)) +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">"age"</span>) +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"none"</span>)</code></pre></div>
<div class="figure">
<img src="ggplotFL_files/figure-html/exbub-1.png" alt="Bubble plot of catch by age in numbners for North Sea plaice." width="432"><p class="caption">
Bubble plot of catch by age in numbners for North Sea plaice.
</p>
</div>
<p>where <em>data</em> is used to size the bubbles in the call to <em>aes()</em>. This single line of code replaces the functionality offered by the <em>lattice</em>-based <em>bubbles()</em> method available in <em>FLCore</em>.</p>
</div>
<div id="example-residual-plots" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#example-residual-plots" class="anchor"> </a></body></html>Example: Residual plots</h2>
<p><strong>TODO</strong>: ADD text</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">catch.n</span>(ple4))
dat$resid &lt;-<span class="st"> </span>dat$data -<span class="st"> </span><span class="kw">mean</span>(dat$data)

<span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(year, <span class="kw">as.factor</span>(age), <span class="dt">size =</span> resid)) +<span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> <span class="kw">factor</span>(<span class="kw">sign</span>(resid)), 
        <span class="dt">fill =</span> <span class="kw">factor</span>(<span class="kw">sign</span>(resid)))) +<span class="st"> </span><span class="kw">scale_size</span>(<span class="dt">range =</span> <span class="kw">c</span>(<span class="dv">1</span>, 
    <span class="dv">20</span>)) +<span class="st"> </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">"black"</span>, 
    <span class="st">"white"</span>)) +<span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">"lightgray"</span>, 
    <span class="st">"black"</span>)) +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"none"</span>) +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">"age"</span>)</code></pre></div>
<p><img src="ggplotFL_files/figure-html/exres-1.png" width="432"></p>

</div>
</div>
<div id="more-information" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#more-information" class="anchor"> </a></body></html>More information</h1>
<ul>
<li>You can submit bug reports, questions or suggestions on <code>ggplotFL</code> at the <code>ggplotFL</code> issue page <a href="#fn6" class="footnoteRef" id="fnref6"><sup>6</sup></a>, or on the <em>FLR</em> mailing list.</li>
<li>Or send a pull request to <a href="https://github.com/flr/ggplotFL/" class="uri">https://github.com/flr/ggplotFL/</a>
</li>
<li>For more information on the FLR Project for Quantitative Fisheries Science in R, visit the FLR webpage <a href="#fn7" class="footnoteRef" id="fnref7"><sup>7</sup></a>.</li>
<li>To learn more about ggplot2, visit the ggplot2 website <a href="#fn8" class="footnoteRef" id="fnref8"><sup>8</sup></a>, or look at the ggplot2 book.<a href="#fn9" class="footnoteRef" id="fnref9"><sup>9</sup></a>
</li>
<li>The latest version of <code>ggplotFL</code> can always be installed using the <code>devtools</code> package, by calling</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(devtools)
<span class="kw">install_github</span>(<span class="st">"flr/ggplotFL"</span>)</code></pre></div>
<div id="software-versions" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#software-versions" class="anchor"> </a></body></html>Software Versions</h2>
<ul>
<li>R version 3.4.1 (2017-06-30)</li>
<li>ggplotFL: 2.6.2</li>
<li>FLCore: 2.6.5</li>
<li>ggplot2: 2.2.1</li>
<li>
<strong>Compiled</strong>: Wed Sep 13 15:23:20 2017</li>
<li>
<strong>Git Hash</strong>: 48fbdda</li>
</ul>
</div>
<div id="author-information" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#author-information" class="anchor"> </a></body></html>Author information</h2>
<p><strong>Iago MOSQUEIRA</strong>. European Commission Joint Research Centre (JRC), Institute for the Protection and Security of the Citizen (IPSC), Maritime Affairs Unit, Via E. Fermi 2749, 21027 Ispra VA, Italy.</p>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Wilkinson, L. 1999. <em>The Grammar of Graphics</em>, Springer. <a href="http://dx.doi.org/10.1007/978-3-642-21551-3_13">doi 10.1007/978-3-642-21551-3_13</a><a href="#fnref1">↩</a></p></li>
<li id="fn2"><p><code>method?as.data.frame('FLQuant')</code><a href="#fnref2">↩</a></p></li>
<li id="fn3"><p><code>method?as.data.frame('FLQuants')</code><a href="#fnref3">↩</a></p></li>
<li id="fn4"><p>For example <code>method?as.data.frame('FLQuants')</code><a href="#fnref4">↩</a></p></li>
<li id="fn5"><p><a href="http://cran.r-project.org/package=reshape2" class="uri">http://cran.r-project.org/package=reshape2</a><a href="#fnref5">↩</a></p></li>
<li id="fn6"><p><a href="https://github.com/flr/ggplotFL/issues" class="uri">https://github.com/flr/ggplotFL/issues</a><a href="#fnref6">↩</a></p></li>
<li id="fn7"><p><a href="http://flr-project.org" class="uri">http://flr-project.org</a><a href="#fnref7">↩</a></p></li>
<li id="fn8"><p><a href="http://ggplot2.org/" class="uri">http://ggplot2.org/</a><a href="#fnref8">↩</a></p></li>
<li id="fn9"><p>Wickham, H. 2009. <em>ggplot2: Elegant Graphics for Data Analysis</em>. Springer, Use R! Series. <a href="http://dx.doi.org/10.1111%2Fj.1467-985X.2010.00676_9.x">doi:10.1111/j.1467-985X.2010.00676_9.x</a><a href="#fnref9">↩</a></p></li>
</ol>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#using-ggplot2-with-flr-objects">Using ggplot2 with <em>FLR</em> objects</a></li>
      <li>
<a href="#the-overloaded-ggplot-method">The overloaded ’ggplot` method</a><ul class="nav nav-pills nav-stacked">
<li><a href="#flquant">FLQuant</a></li>
      <li><a href="#flquants">FLQuants</a></li>
      <li><a href="#flstock">FLStock</a></li>
      </ul>
</li>
      <li>
<a href="#new-plot-methods-for-flr-classes">New <code>plot()</code> methods for FLR classes</a><ul class="nav nav-pills nav-stacked">
<li><a href="#flquant-1">FLQuant</a></li>
      <li><a href="#flquants-1">FLQuants</a></li>
      <li><a href="#flstock-1">FLStock</a></li>
      <li><a href="#flstocks">FLStocks</a></li>
      <li><a href="#flsr">FLSR</a></li>
      <li><a href="#flsrs">FLSRs</a></li>
      </ul>
</li>
      <li><a href="#using-ggplot2-directly-by-converting-to-data.frame">Using ggplot2 directly by converting to data.frame</a></li>
      <li>
<a href="#some-examples">Some examples</a><ul class="nav nav-pills nav-stacked">
<li><a href="#example-plot-quantiles-of-a-simulation">Example: plot quantiles of a simulation</a></li>
      <li><a href="#example-simulation-trajectories-plot">Example: Simulation trajectories plot</a></li>
      <li><a href="#example-using-flquants">Example: Using FLQuants</a></li>
      <li><a href="#example-bubble-plots">Example: Bubble plots</a></li>
      <li><a href="#example-residual-plots">Example: Residual plots</a></li>
      </ul>
</li>
      <li>
<a href="#more-information">More information</a><ul class="nav nav-pills nav-stacked">
<li><a href="#software-versions">Software Versions</a></li>
      <li><a href="#author-information">Author information</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Iago Mosqueira, Laurence T. Kell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
